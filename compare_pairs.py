"""
Used to compute differences between reference base pairing and experimental 
base pairing. Ignore for users.
"""


def compare_pairs(ref_list, exp_list):
    real_matches = dict()
    in_matches = set()
    for tup in ref_list:
        i, j = tup
        real_matches[i] = j
        in_matches.add(i)
        in_matches.add(j)
    match = 0
    semi_match = 0
    total = len(real_matches)
    for tup in exp_list:
        i, j = tup
        if i in real_matches.keys() and real_matches[i] == j:
            match += 1
        if i in in_matches:
            semi_match += 1
        if j in in_matches:
            semi_match += 1
    print(match/total, semi_match/len(in_matches))


compare_pairs(
    [(19, 100), (20, 99), (21, 98), (22, 97), (23, 96), (24, 95), (25, 94), (26, 93), (27, 92), (34, 86), (35, 85), (36, 84), (37, 83), (46, 78), (47, 77), (48, 76), (49, 75), (50, 74), (51, 73), (52, 72), (53, 71), (62, 138), (63, 137), (64, 136), (65, 135), (66, 134), (67, 133), (68, 131), (69, 130), (70, 129), (161, 307), (164, 304), (165, 303), (166, 302), (167, 301), (173, 291), (174, 290), (175, 289), (176, 288), (177, 285), (178, 284), (179, 283), (180, 282), (182, 277), (183, 276), (184, 275), (185,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            274), (186, 273), (187, 272), (188, 271), (190, 268), (191, 267), (192, 266), (193, 265), (203, 242), (204, 241), (205, 240), (206, 239), (207, 238), (209, 237), (210, 236), (211, 235), (212, 234), (215, 230), (216, 229), (217, 228), (244, 256), (245, 255), (246, 254), (247, 253), (318, 379), (319, 378), (320, 377), (321, 376), (322, 375), (323, 373), (324, 372), (325, 371), (327, 369), (328, 368), (337, 365), (338, 364), (339, 363), (340, 361), (341, 360), (343, 358), (344, 357), (345, 356), (346, 355)],
    [(46, 104), (47, 103), (48, 102), (49, 101), (50, 100), (51, 99), (52, 98), (53, 97), (142, 163), (143, 162), (144, 161), (145, 160), (146, 159), (147, 158), (148, 157), (291, 348), (292, 347), (293, 346), (294, 345), (295, 344), (296, 343), (297, 342), (298, 341), (164, 238), (165, 237), (166, 236), (167, 235), (168, 234), (182, 277), (183, 276), (184, 275), (185, 274), (186, 273), (187, 272), (76, 299), (77, 290), (78, 289), (79, 288), (246, 263), (247, 262), (248, 261), (249, 260), (250, 259), (197, 256), (198, 255), (199, 254), (200, 253), (201, 252), (202, 251), (214, 231), (215, 230), (216, 229), (217, 228), (218, 227), (91, 286), (92, 285), (93, 284), (94, 283), (154, 282), (155, 281), (156, 280), (169, 279), (170, 278), (150, 191), (151, 190), (152, 189), (153, 188), (171, 181), (172, 180), (61, 139), (62, 138), (63, 137), (64, 136), (65, 135), (66, 134), (73, 112), (74, 111), (75, 110), (80, 109), (81, 108), (21, 384), (22,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   383), (23, 382), (24, 381), (25, 380), (69, 120), (70, 119), (71, 118), (72, 117), (82, 116), (58, 351), (59, 350), (60, 349), (67, 340), (68, 339), (328, 376), (329, 375), (330, 374), (331, 373), (332, 372), (333, 371), (334, 370), (178, 268), (179, 267), (192, 266), (196, 243), (203, 242), (204, 241), (205, 240), (173, 213), (174, 212), (175, 211), (176, 210), (301, 356), (302, 355), (303, 354), (304, 353), (305, 352), (29, 312), (30, 311), (31, 310), (32, 309), (33, 308), (34, 307), (35, 306), (36, 300), (37, 287), (38, 271), (39, 270), (19, 313), (20, 269), (26, 265), (88, 193), (89, 177), (90, 149), (95, 141), (86, 365), (87, 364), (96, 363), (105, 362), (106, 361), (140, 319), (194, 318), (195, 317), (132, 336), (133, 335), (206, 327), (207, 326), (208, 325), (5, 338), (6, 337), (7, 324), (114, 314), (115, 264), (121, 258), (122, 257), (4, 377), (8, 369), (9, 368), (1, 358), (2, 357), (3, 323), (54, 129), (55, 128), (56, 127)]
)
